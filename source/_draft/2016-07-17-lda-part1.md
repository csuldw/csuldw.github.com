

LDA需要掌握的五大内容：

1. 一个函数：Gamma函数
2. 五大分布：伯努利分布、二项分布、多项分布、Beta分布、Dirichlet分布
3. 两个理论：共轭先验 & 贝叶斯
4. 两个模型：pLSA & LDA
5. 一个采样：Gibbs采样


## 一个函数 & 五大分布

根据上面的内容，先来回顾下Gamma函数和五大分布：

#### Gamma函数

Gamma函数是阶乘在史书上的而推广，公式如下：

$$\Gamma(k) = \int_0^\infty x^{k-1} e^{-x} \, dx, \quad k \in (0, \infty)$$

性质：

$$\Gamma(n) = (n-1)!$$

#### 伯努利分布

伯努利分布（Bernoulli distribution）是关于布尔变量$x \epsilon \{0, 1\}$的概率分布，其连续参数$\mu \epsilon [0,1] $表示变量$x=1$的概率.

$$p(x | \mu) = B(x | \mu) = \mu ^{x} (1-\mu)^{1-x}$$

对于伯努利分布，它的期望和方差如下：

$$E(x) = \mu$$
$$D(x) = \mu(1-\mu)$$

#### 二项分布

二项分布（binomial distribution）描述的是n次独立的伯努利分布中有m次成功（即$x=1$）的概率，其中每次伯努利实验成功的概率都是$\mu \epsilon [0,1] $.

$$p(m|n,\mu) = Bin(m | n,\mu) = C_{n} ^{m} \mu^{m}(1-\mu)^{n-m}$$

对于二项分布，它的期望和方差如下：

$$E(x) = n\mu$$
$$D(x) = n\mu(1-\mu)$$

当$n=1$时，二项分布即为伯努利分布.

#### 多项分布

将伯努利分布的单变量扩展到$d$维向量$\vec{x}$,其中$x_i \epsilon \{0,1\}$,且$\sum_{i=1}^d x_i = 1$，假设$x_i =1 $的概率为 $\mu \epsilon [0, 1]$, 并且$\sum_{i=1}^d \mu_i = 1$，则将得到离散分布

$$p(x| \mu) = \prod_{i=1}^{d} \mu_{i}^{x_{i}}$$

在此基础上扩展二项分布得到多项式分布（multinomial distribution），该分布描述的是在n次独立实验中有$m_i$次$x_i = 1$的概率.


$$p(m_1, m_2, ..., m_d | n, \mu) = \frac{n!}{m_1!m_2!...m_d !} \prod_{i=1}^{d} \mu_{i}^{m_{i}}$$

多项式分布的期望、方差、协方差如下：

$$E(x) = n\mu_i$$
$$D(x) = n\mu_i (1-\mu_i)$$
$$cov(m_i, m_j) = -n \mu_i \mu_j$$

#### Beta分布

Beta分布是二项分布的共轭先验分布，下面先介绍两个函数，Beta函数和Gamma函数（直接贴公式吧）：

$$B(a, b) = \frac{\Gamma(a) \Gamma(b)}{\Gamma(a + b)}; \quad a, \, b \in (0, \infty)$$

$$\Gamma(k) = \int_0^\infty x^{k-1} e^{-x} \, dx, \quad k \in (0, \infty)$$

贝塔分布（Beta distribution）是关于连续变量$\mu \epsilon [0, 1]$的概率分布，它由两个参数$a$和$b$共同确定，概率密度函数如下：

$$Beta(\mu | a,b) = \frac{1}{B(a, b)} \mu^{a-1} (1 - \mu)^{b-1}, \quad 0 <  x <  1$$

Beta分布的期望和方差如下：

$$E(\mu) = \frac{a}{a+b}$$

$$D(\mu) = \frac{ab}{(a+b)^2 (a+b+1)}$$

#### 狄利克雷分布

狄利克雷分布（Dirichlet distribution）是Beta分布在高维度上的推广，它是关于一组$d$个连续变量$\mu_i \epsilon [0, 1]$ 的概率分布，$\sum_{i=1}^d \mu_{i} = 1$,令$\mu = (\mu_{i}, \mu_{2}, ..., \mu_{d})$,参数$\alpha = (\alpha_{1}, \alpha_{2}, ..., \alpha_{d})$, $\alpha_{i}>0$, $\tilde{alpha} = \sum_{i=1}^{d} \alpha_{i}$.

$$p(\mu; \alpha) = D(\mu; \alpha) = \frac{\Gamma(\tilde{\alpha})}{\Gamma(\alpha_{1})...\Gamma(\alpha_{i})} \prod_{i=1}^{d} \mu_{i}^{\alpha_{i}-1} $$

Dirichlet 分布的期望和方差如下：

$$E(\mu_{i}) = \frac{\alpha_{i}}{\tilde{\alpha}}$$

$$D(\mu_{i}) = \frac{\alpha_{i}(\tilde{\alpha - \alpha_{i}})}{\tilde{\alpha}^{2}(\tilde{\alpha} + 1)}$$

$$cov(\mu_{i}, \mu_{j}) = \frac{\alpha_{i}\alpha_{j}}{\tilde{\alpha}^{2}(\tilde{\alpha} + 1)}$$

当$d=2$时，狄利克雷分布退化为Beta分布.


若先验分布和抽样分布决定的后验分布与先验分布是同类型分布，则称先验分布为后验分布或抽样分布的**共轭分布。**

小结：Beta分布与伯努利分布共轭，多项式分布的共轭分布是狄利克雷分布，高斯分布的共轭分布是高斯分布。


---





将文档集中每篇文档的主题以概率分布的形式给出，从而通过分析一些文档抽取出它们的主题（分布）出来后，便可以根据主题（分布）进行主题聚类或文本分类。

如何生成一篇文档？

给定几个topic以及通过训练之后得到的每个topic对应的一组word，首先一篇doc会以一定概率选择某个topic，该topic又会以一定概率选择某个word，逐步迭代，知道生成一篇完整的doc。


在LDA模型中，一篇文档生成的方式如下：

- 首先从狄利克雷分布$\alpha$中取样生成文档 $i$ 的主题分布$\theta_i $
- 然后从主题的多项式分布 $\theta_i $ 中取样生成文档 $i$ 的第 $j$ 个词的主题 $z_{i,j} $
- 其次从狄利克雷分布 $\beta$ 中取样生成主题对应的词语分布$\phi_{z_{i,j}}$
- 最后从词语多项式分布$\phi_{z_{i,j}}$ 中采样生成词语 $w_{i,j}$


其中$\theta_i$是文档$i$的主题分布向量，向量的每一列表示每个主题在文档$i$出现的概率，该向量为非负归一化向量；



## 参考文献

- [special distribution](http://www.math.uah.edu/stat/special/index.html)
- [Gamma distribution](http://www.math.uah.edu/stat/special/Gamma.html#gam)
- [Beta distribution](http://www.math.uah.edu/stat/special/Beta.html)
